/* Grapho Copyright (c) 2014 Robin Nilsson <robinnilsson@gmail.com> - MIT License */
(function(t,v){"function"===typeof define&&define.amd?define([],v):t.Grapho=v()})(this,function(){function t(a){if(!(this instanceof t))return new t(a);this.defs=h.object.merge({},z);void 0!==a.theme?h.object.is(a.theme)?this.defs=h.object.merge(this.defs,h.object.merge(w.dark,a.theme)):void 0!==w[a.theme]?this.defs=h.object.merge(this.defs,w[a.theme]):console.error("Grapho: Theme not found ("+a.theme+")"):this.defs=h.object.merge(this.defs,w.dark);this.yAxises=[];this.xAxises=[];this.datasets=[];
this.container=this.defs.container;this.settings=h.object.merge(this.defs.settings,a);this.id=v.push(this)-1;this.canvas=document.createElement("canvas");this.ctx=this.canvas.getContext("2d");this.nwoy=this.nwox=this.woy=this.wox=this.wsh=this.wsw=this.h=this.w=0;a.place&&this.place(a.place);this.done=!0}var v=[],y={"default":function(a){var b;return h.math.isNumber(a)?Math.round(a,19)===(b=parseInt(a))?b:a:a},datetime:function(a){return h.math.isNumber(a)?(new Date(1E3*a)).toLocaleString():a},date:function(a){return h.math.isNumber(a)?
(new Date(1E3*a)).toLocaleDateString():a},time:function(a){return h.math.isNumber(a)?(new Date(1E3*a)).toLocaleTimeString():a}},z={container:{width:"auto",height:"auto"},settings:{margin:5,showLegend:!1,legend:{position:"bottom",inside:!1},startAngle:90,sizePercent:1,relative:!0,innerMargin:3},dataset:{type:"line",x:{axis:1},y:{axis:1},lineWidth:2,lineSmooth:!0,dotWidth:4,widthPrc:90,_labels:[],_usedPos:[],_usedNeg:[],_data:[]},axis:{min:"auto",max:"auto",showscale:!1,gridLines:!1,name:void 0,labels:!1,
labelFormat:y["default"],labelRotation:0,showCenter:!1,majorTickHeight:4,center:0,padded:!1,stacked:!1,numeric:!0,_nameTextSize:0,_labelTextSize:0,_h:void 0,_step:Infinity,_steps:0,_minStepPrc:1,_range:0,_startMinVal:0,_minVal:Infinity,_maxVal:-Infinity,_padded:!1,_values:[],_labels:[],_usedPos:[],_usedNeg:[]}},w={dark:{settings:{fillStyle:"rgb(0,0,0,0)",legend:{fillStyle:"none",strokeStyle:"none",font:"11px Droid Sans"}},dataset:{strokeStyle:"#454545",fillStyle:"#343536"},axis:{scaleStyle:"#FFFFFF",
gridStyle:"#353637",nameFont:"auto",nameStyle:"auto",labelFont:"11px Droid Sans",labelStyle:"auto"}},light:{settings:{fillStyle:"rgb(0,0,0,0)",legend:{fillStyle:"none",strokeStyle:"none",font:"11px Droid Sans"}},dataset:{strokeStyle:"#AAAAAA",fillStyle:"#F0F099"},axis:{scaleStyle:"#AAAAAA",gridStyle:"#BBBBBB",nameFont:"auto",nameStyle:"auto",labelFont:"11px Droid Sans",labelStyle:"auto"}}},h={array:{is:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},unique:function(a){for(var b=
{},c=[],d=0,f=a.length;d<f;++d)b.hasOwnProperty(a[d])||(c.push(a[d]),b[a[d]]=1);return c}},object:{is:function(a){return"[object Object]"===Object.prototype.toString.call(a)},merge:function(a,b,c){var d;void 0===c&&(a=h.object.merge({},a,!0));for(d in b)void 0!==b[d]&&(a[d]&&"[object Object]"===Object.prototype.toString.call(a[d])?a[d]=h.object.merge(h.object.merge({},a[d]),b[d],!0):"[object Array]"===h.array.is(b[d])?a[d]=b[d].slice():a[d]=b[d]);return a}},renderers:{area:function(a,b,c,d,f){h.renderers.line(a,
b,c,d,f)},box:function(a,b,c,d,f){h.renderers.error(a,b,c,d,f)},ohlc:function(a,b,c,d,f){h.renderers.error(a,b,c,d,f)},candle:function(a,b,c,d,f){h.renderers.error(a,b,c,d,f)},line:function(a,b,c,d,f){var e,g,k,m,h,n,q,l;b.beginPath();g=d._minStepPrc;g*=a.wsw-g*a.wsw*(d._padded?1:0);m=d._padded?g/2:0;h=a.wsw-2*m;for(g=0;g<c.data.length;g++)if(e=c.data[g])n=(e[0]-d._minVal)/d._range,n=Math.round(a.wox+m+h*n),q=Math.round(a.woy+(e[1]+e[3]-f._minVal)/f._range*a.wsh),g?c.lineSmooth&&g<c.data.length-1?
(e=c.data[g+1],k=(e[0]-d._minVal)/d._range,b.quadraticCurveTo(n,q,(n+(e?Math.round(a.wox+m+h*k):0))/2,(q+(e?Math.round(a.woy+(e[1]-f._minVal)/f._range*a.wsh):0))/2)):b.lineTo(n-1,q):b.moveTo(l=n+1,q);b.lineWidth=c.lineWidth;b.strokeStyle=c.strokeStyle;b.stroke();"area"===c.type&&(a=Math.round(a.woy+((f.center<f._minVal?f._minVal:f.center>f._maxVal?f._maxVal:f.center)-f._minVal)/f._range*a.wsh)+.5,b.lineTo(n-1,a),b.lineTo(l,a),b.strokeStyle="rgba(0,0,0,0)",b.stroke(),b.fillStyle=c.fillStyle,b.fill())},
band:function(a,b,c,d,f){var e,g,k,m,h,n,q,l;b.beginPath();g=d._minStepPrc;g*=a.wsw-g*a.wsw*(d._padded?1:0);n=d._padded?g/2:0;q=a.wsw-2*n;for(k=0;2>k;k++)for(g=0;g<c.data.length;g++)if(m=0===k?g:c.data.length-g-1,e=c.data[m])l=(e[0]-d._minVal)/d._range,l=Math.round(a.wox+n+q*l),e=Math.round(a.woy+(e[1][k]-f._minVal)/f._range*a.wsh),m||0!==k?c.lineSmooth&&m<c.data.length-1&&0<m?(m=c.data[m+(k?-1:1)],h=(m[0]-d._minVal)/d._range,b.quadraticCurveTo(l,e,(l+(m?Math.round(a.wox+n+q*h):0))/2,(e+(m?Math.round(a.woy+
(m[1][k]-f._minVal)/f._range*a.wsh):0))/2)):b.lineTo(l-1,e):b.moveTo(l+1,e);b.fillStyle=c.fillStyle;b.fill()},error:function(a,b,c,d,f){var e,g,k,m,h,n,q,l,p,r,s,u;k=d._minStepPrc;k*=a.wsw-k*a.wsw*(d._padded?1:0);m=d._padded?k/2:0;h=a.wsw-2*m;q=k*(100-c.widthPrc)/100;n=k-q;b.lineWidth=c.lineWidth;b.strokeStyle=c.strokeStyle;b.fillStyle=c.fillStyle;for(g=0;g<c.data.length;g++)if(e=c.data[g]){l=Math.round(a.wox-k/2+m+q/2+(e[0]-d._minVal)/d._range*h);p=Math.round(a.woy+(e[1][0]-f._minVal)/f._range*a.wsh);
r=Math.round(a.woy+(e[1][1]-f._minVal)/f._range*a.wsh);s=Math.round(a.woy+(e[1][2]-f._minVal)/f._range*a.wsh);u=Math.round(a.woy+(e[1][3]-f._minVal)/f._range*a.wsh);e=Math.round(a.woy+(e[1][4]-f._minVal)/f._range*a.wsh);b.beginPath();if("error"===c.type||"box"===c.type)b.moveTo(l,p),b.lineTo(l+n,p);b.moveTo(Math.round(l+n/2),p);b.lineTo(Math.round(l+n/2),r);"ohlc"===c.type&&(b.moveTo(l,s),b.lineTo(l+n/2,s),b.moveTo(l+n/2,u),b.lineTo(l+n,u));b.stroke();b.beginPath();if("candle"===c.type||"box"===c.type)b.fillRect(l,
s,n,u-s),b.strokeRect(l,s,n,u-s);"box"===c.type&&(b.moveTo(l,e),b.lineTo(l+n,e));if("error"===c.type||"box"===c.type)b.moveTo(l,r),b.lineTo(l+n,r);b.stroke()}},bar:function(a,b,c,d,f){var e,g,k,m,h,n,q,l,p,r;m=d._minStepPrc;m*=a.wsw-m*a.wsw*(d._padded?1:0);k=d._padded?m/2:0;r=a.wsw-2*k;n=m*(100-c.widthPrc)/100;q=m-n;for(h=0;h<c.data.length;h++)if(e=c.data[h])g=(e[0]-d._minVal)/d._range,g=Math.round(a.wox-m/2+k+n/2+g*r),l=Math.round(a.woy+(e[1]+e[3]-f._minVal)/f._range*a.wsh),e=Math.round(a.woy+(e[3]-
f._minVal)/f._range*a.wsh)-l,(p=Math.abs(e)>2*c.lineWidth)?b.fillStyle=c.fillStyle:b.fillStyle=c.strokeStyle,b.fillRect(g,l,q,e),0<c.lineWidth&&p&&(b.strokeStyle=c.strokeStyle,b.lineWidth=c.lineWidth,b.strokeRect(Math.round(g+b.lineWidth/2),Math.round(l-b.lineWidth/2),q-b.lineWidth-.5,e+b.lineWidth-1))},scatter:function(a,b,c,d,f){var e,g,k,h,p;e=d._minStepPrc;e*=a.wsw-e*a.wsw*(d._padded?1:0);k=d._padded?e/2:0;p=a.wsw-2*k;for(h=0;h<c.data.length;h++)if(e=c.data[h])g=(e[0]-d._minVal)/d._range,b.beginPath(),
b.arc(Math.round(a.wox+k+p*g),Math.round(a.woy+(e[1]+e[3]-f._minVal)/f._range*a.wsh),c.dotWidth,0,2*Math.PI),b.fillStyle=c.fillStyle,b.fill()},pie:function(a,b,c,d,f){var e=1-a.settings.sizePercent,g;for(d=0;d<c.data.length;d++){g=1-d/c.data.length*(1-e);b.fillStyle=c.fillStyle;var k=b,m=a.wsw/2+a.wox,p=a.wsh/2+a.woy,n=(a.wsw>a.wsh?a.wsh/2:a.wsw/2)*(g+.01);g=(a.wsw>a.wsh?a.wsh/2:a.wsw/2)*(g-1/c.data.length*(1-e))+a.settings.innerMargin;var q=(c.data[d][3]/f._usedPos[d]*360+a.settings.startAngle)*
h.math.degToRad,l=q+(c.data[d][1]/f._usedPos[d]*360+.5)*h.math.degToRad;k.beginPath();k.arc(m,p,n,q,l,!1);k.arc(m,p,g,l,q,!0);k.closePath();k.fill()}}},math:{degToRad:.0174532925,log10:function(a){return Math.log(a)/Math.LN10},isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},isInt:function(a){return 0===a%1},bboxrot:function(a,b,c){c*=h.math.degToRad;return{width:Math.max(Math.abs(a*Math.cos(c)+b*Math.sin(c)),Math.abs(a*Math.cos(c)-b*Math.sin(c))),height:Math.max(Math.abs(-a*Math.sin(c)+
b*Math.cos(c)),Math.abs(-a*Math.sin(c)-b*Math.cos(c)))}}}},p;p=t.prototype;t.formats=p.formats=y;p.place=function(a){var b;"string"===typeof a&&(a=document.getElementById(a));if(b=a&&(a.appendChild?"appendChild":"append"))this.dest=a,this.dest[b](this.canvas),this.resize(this);return this};p.removeDataset=function(a){a=this.datasets.indexOf(a);-1!==a&&this.datasets.splice(a)};p.addDataSet=function(a){var b=h.array.is(a);if("object"!==typeof a||!b&&!a.data)return this;var c=this.defs.dataset;b?c.data=
a:c=h.object.merge(c,a);"bar"===a.type&&void 0===a.lineWidth&&(c.lineWidth=0);this.yAxises[c.y.axis]=h.object.merge(this.defs.axis,h.object.merge(this.yAxises[c.y.axis],c.y));this.xAxises[c.x.axis]=h.object.merge(this.defs.axis,h.object.merge(this.xAxises[c.x.axis],c.x));this.pushDataset(c);this.done&&this.redraw();return c};p.updateAxises=function(a){var b=this.yAxises[a.y.axis],c=this.xAxises[a.x.axis],d,f,e,g=a.data.length,k=[],m=[];if(!h.array.is(a.data[0]))for(d=0;d<g;d++)k[d]=a.data[d],m[d]=
d,a.data[d]=[d,a.data[d]];for(d=0;d<g;d++){void 0!==a.data[d][2]&&(a.data[d][0]=a.data[d][2]);e=-1;for(f=0;f<c._labels.length;f++)c._labels[f]===a.data[d][0]&&(e=f);a.data[d][2]=a.data[d][0];-1<e||(e=c._labels.push(a.data[d][0])-1);a.data[d][0]=m[d]=e;h.array.is(a.data[d][1])?k=k.concat(a.data[d][1]):k[d]=a.data[d][1];a.data[d][3]=0;!h.array.is(a.data[d][1])&&(void 0===b._usedPos[e]&&(b._usedPos[e]=0),void 0===b._usedNeg[e]&&(b._usedNeg[e]=0),b.stacked||"pie"===a.type||"progress"===a.type)&&(a.data[d][1]>=
b.center?(a._usedPos[e]=a.data[d][3]=void 0===b._usedPos[e]?0:b._usedPos[e],b._usedPos[e]+=a.data[d][1]):(a._usedNeg[e]=a.data[d][3]=void 0===b._usedNeg[e]?0:b._usedNeg[e],b._usedNeg[e]+=a.data[d][1]))}"string"===typeof a.data[0][0]&&(c.numeric=!0);b.stacked?(b._maxVal="auto"!==b.max?b.max:Math.max(Math.max.apply(null,b._usedPos),b._maxVal),b._minVal="auto"!==b.min?b.min:Math.min(Math.min.apply(null,b._usedNeg),b._minVal)):(b._maxVal="auto"!==b.max?b.max:Math.max(Math.max.apply(null,k),b._maxVal),
b._minVal="auto"!==b.min?b.min:Math.min(Math.min.apply(null,k),b._minVal));c._maxVal="auto"!==c.max?c.max:Math.max(Math.max.apply(null,m),c._maxVal);c._minVal="auto"!==c.min?c.min:Math.min(Math.min.apply(null,m),c._minVal);c._values=h.array.unique(c._values.concat(m));b._values=h.array.unique(b._values.concat(k));c._range=c._maxVal-c._minVal;b._range=b._maxVal-b._minVal;a.data.sort(function(a,b){return a[0]-b[0]});c=this.calcMinStep(c,a.data,0);b=this.calcMinStep(b,a.data,1);!0!==c.numeric?(c._step=
1,c._steps=c._labels.length-1):c=this.calcAxisSteps(c);b=this.calcAxisSteps(b);if("bar"===a.type||"error"===a.type||"ohlc"===a.type||"candle"===a.type||"box"===a.type)c._padded=!0;return this};p.pushDataset=function(a){var b;this.xAxises[a.x.axis]._values=[];this.yAxises[a.y.axis]._values=[];this.xAxises[a.x.axis]._labels=[];this.yAxises[a.y.axis]._labels=[];this.yAxises[a.y.axis]._usedPos=[];this.yAxises[a.y.axis]._usedNeg=[];for(b=0;b<this.datasets.length;b++)this.datasets[b].x.axis!==a.x.axis&&
this.datasets[b].y.axis!==a.y.axis||this.updateAxises(this.datasets[b]);this.updateAxises(a);this.datasets.push(a);return this};p.calcAxisSteps=function(a,b){var c,d,f;c=a._range/(void 0===b?15:b);f=a._range*a._minStepPrc;d=Math.floor(h.math.log10(c));d=Math.pow(10,d);c=Math.round(c/d+.5);5<c?c=10:2<c?c=5:1<c&&(c=2);c*=d;c<f&&(c=f);a._startMinVal=a._minVal-a._minVal%c;f=Math.round(Math.ceil(a._range/c));a._step=c;a._steps=f;return a};p.calcMinStep=function(a,b,c){var d,f=a._minStepPrc,e,g;for(d=0;d<
b.length;d++)if(g=b[d])g=(g[c]-a._minVal)/a._range,void 0!==e&&g-e<f&&(f=g-e),e=g;a._minStepPrc=f;return a};p.drawAxis=function(a,b,c,d){var f,e,g,k,m,p,n,q,l,t,r,s,u,v,w,x;a.lineWidth=1;a.strokeStyle=b.gridStyle;k="x"===c?this.w:this.h;m="x"===c?this.h:this.w;"x"===c?(a.save(),a.scale(1,-1),a.translate(0,-this.h),a.translate(0,m),a.rotate(-.5*Math.PI),l=this.wsh,t=this.wsw,r=this.woy,s=this.wox):(l=this.wsw,t=this.wsh,s=this.woy,r=this.wox);f=b._minStepPrc;f*=l-f*l*(b._padded?1:0);w=b._padded?f/
2:0;v=l-2*w;a.font=b.labelFont;p=[+Math.abs(b._step),-Math.abs(b._step)];for(n=0;n<p.length;n++)for(q=b._startMinVal;q<=b._maxVal&&q>=b._minVal;)f=Math.round(r+w+(q-b._minVal)/b._range*v),b.showGridLines&&(a.beginPath(),a.moveTo(f,s),a.lineTo(f,s+t),a.strokeStyle=b.gridStyle,a.stroke()),b.labels&&(a.font=b.labelFont,a.save(),a.beginPath(),x=b.labelRotation+90+("y"===c?90:0),u=b._labels&&void 0!==b._labels[q]?b.labelFormat(b._labels[q]):b.labelFormat(q),g=h.math.bboxrot(a.measureText(u).width,b._labelTextSize,
x),"y"===c?(a.scale(-1,1),a.translate(-this.w,0),e=m-f):e=f,g=b._offset+b._h-1.2*g.height/2-(b.showScale?b.majorTickHeight+1:0)-2,d||(g=k-g),a.translate(e,g),a.rotate(x*h.math.degToRad),a.translate(-a.measureText(u).width/2,b._labelTextSize/3),a.fillStyle="auto"===b.labelStyle?b.scaleStyle:b.labelStyle,a.fillText(u,0,0),a.restore()),b.showScale&&(a.beginPath(),e=b._offset+b._h-1,d?(a.moveTo(f,e),a.lineTo(f,e-b.majorTickHeight)):(a.moveTo(f,k-e),a.lineTo(f,k-e+b.majorTickHeight)),a.strokeStyle=b.scaleStyle,
a.stroke()),q+=p[n];b.showCenter&&b.center>b._minVal&&b.center<b._maxVal&&(f=Math.round(r+w+(b.center-b._minVal)/b._range*v),a.beginPath(),a.moveTo(f,s),a.lineTo(f,s+t),a.strokeStyle=b.scaleStyle,a.stroke());b.showScale&&(a.beginPath(),d?(a.moveTo(r,b._offset+b._h-1),a.lineTo(r+l,b._offset+b._h-1)):(a.moveTo(r,k-b._offset-b._h+1),a.lineTo(r+l,k-b._offset-b._h+1)),a.strokeStyle=b.scaleStyle,a.stroke());a.font=b.nameFont;b.name&&(a.font="auto"===b.nameFont?b.labelFont:b.nameFont,a.fillStyle="auto"===
b.nameStyle?b.scaleStyle:b.nameStyle,f=d?b._offset+b._nameTextSize/1.2:k-b._offset-b._nameTextSize/2.2,a.save(),"y"===c?(a.scale(1,-1),a.translate(0,-this.h),e=k-f+b._nameTextSize/1.9):e=f,a.fillText(b.name,r+l/2-a.measureText(b.name).width/2,e),a.restore());"x"===c&&a.restore()};p.drawLegend=function(a,b){var c=0,d=0,f=1,e=1.2*parseInt(a.font.split(" ")[0]),g,k,h=a.inside?this.nwoy:this.settings.margin,p=a.inside?this.wox+5:this.settings.margin,n=a.inside?this.wsw:this.w,q=a.inside?this.wsh:this.h;
this.ctx.font=a.font;for(g=0;g<this.datasets.length;g++)void 0===this.datasets[g].name&&(this.datasets[g].name="Series "+(g+1)),"bottom"===a.position||"top"===a.position?(d+this.ctx.measureText(this.datasets[g].name).width+e+e>n&&(f+=1,d=0),d+=this.ctx.measureText(this.datasets[g].name).width+e+e,c=e*f):((k=this.ctx.measureText(this.datasets[g].name).width)>d&&(d=k),c=d+e);if(!b)for(d=0,f=1,g=0;g<this.datasets.length;g++)this.ctx.fillStyle=this.datasets[g].fillStyle,this.ctx.strokeStyle=this.datasets[g].strokeStyle,
"bottom"===a.position||"top"===a.position?(d+this.ctx.measureText(this.datasets[g].name).width+e+e>n&&(f+=1,d=0),k=("bottom"===a.position?q+h-c:h)+(f-1)*e+3,this.ctx.fillRect(d+p,k,e-6,e-6),this.ctx.strokeRect(d+p,k,e-6,e-6),this.ctx.fillText(this.datasets[g].name,d+e+p,k+e/1.35),d+=this.ctx.measureText(this.datasets[g].name).width+e+e):(k="right"===a.position?n+p-c:p,this.ctx.fillRect(k,h+(f-1)*e+3,e-6,e-6),this.ctx.strokeRect(k,h+(f-1)*e+3,e-6,e-6),this.ctx.fillText(this.datasets[g].name,k+e,h+
(f-1)*e+e/1.35),f+=1);return c};p.calcAxisSpace=function(a,b,c){var d,f,e,g;a._labelTextSize=a.labels?parseInt(a.labelFont.split(" ")[0]):0;a._nameTextSize=void 0!==a.name?"auto"!==a.nameFont?parseInt(a.nameFont.split(" ")[0]):parseInt(a.labelFont.split(" ")[0]):0;a._h=0;a._h+=a.showScale?1:0;a._h+=a.showScale?a.majorTickHeight:0;a._h+=a.name?1.7*a._nameTextSize:0;if(a.labels){b.font=a.labelFont;d=0;for(f=a._minVal;f<=a._maxVal;f+=a._step)e=a._labels&&void 0!==a._labels[f]?b.measureText(a.labelFormat(a._labels[f])).width:
b.measureText(a.labelFormat(f)).width,g=a._labelTextSize,e=1.2*h.math.bboxrot(e,g,a.labelRotation+("x"===c?90:0)).width,1,e>d&&(d=e);a._h+=d}return a};p.redraw=function(){var a,b,c;this.wsw=this.w-2*this.settings.margin;this.wsh=this.h-2*this.settings.margin;this.nwoy=this.nwox=this.woy=this.wox=this.settings.margin;this.settings.showLegend&&!this.settings.legend.inside&&(c=this.drawLegend(this.settings.legend,!0)+this.settings.margin,"bottom"===this.settings.legend.position?(this.woy+=c,this.wsh-=
c):"top"===this.settings.legend.position?(this.nwoy+=c,this.wsh-=c):"left"===this.settings.legend.position?(this.wox+=c,this.wsw-=c):"right"===this.settings.legend.position&&(this.nwox+=c,this.wsw-=c));for(a in this.yAxises)this.yAxises.hasOwnProperty(a)&&(this.yAxises[a]=this.calcAxisSpace(this.yAxises[a],this.ctx,"y"),this.wsw-=this.yAxises[a]._h,this.yAxises[a]._offset=a%2?this.wox:this.nwox,a%2?this.wox+=this.yAxises[a]._h:this.nwox+=this.yAxises[a]._h);for(a in this.xAxises)this.xAxises.hasOwnProperty(a)&&
(this.xAxises[a]=this.calcAxisSpace(this.xAxises[a],this.ctx,"x"),this.wsh-=this.xAxises[a]._h,this.xAxises[a]._offset=a%2?this.woy:this.nwoy,a%2?this.woy+=this.xAxises[a]._h:this.nwoy+=this.xAxises[a]._h);c=this.ctx;c.clearRect(0,0,this.w,this.h);c.save();c.translate(.5,.5);c.scale(1,-1);c.translate(0,-this.h);for(a in this.yAxises)this.yAxises.hasOwnProperty(a)&&this.drawAxis(c,this.yAxises[a],"x",a%2);for(a in this.xAxises)this.xAxises.hasOwnProperty(a)&&this.drawAxis(c,this.xAxises[a],"y",a%2);
for(a=this.datasets.length-1;0<=a;a--)if(b=this.datasets[a],void 0!==h.renderers[b.type]||"area"===b.type)h.renderers[b.type](this,c,b,this.xAxises[b.x.axis],this.yAxises[b.y.axis]);else console.error('Grapho: Missing renderer "'+b.type+'", cannot render dataset.');c.restore();this.settings.showLegend&&this.drawLegend(this.settings.legend,!1)};p.resize=function(){"auto"===(this.w=this.container.width)&&(this.w=getComputedStyle(this.dest,null).getPropertyValue("width"));"auto"===(this.h=this.container.height)&&
(this.h=getComputedStyle(this.dest,null).getPropertyValue("height"));this.canvas.height=this.h=parseInt(this.h);this.canvas.width=this.w=parseInt(this.w);this.redraw();return this};window.addEventListener("resize",function(){for(var a,b=0;a=v[b++];)a.resize()});return t});