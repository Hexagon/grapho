!function(t,e){"use strict";"function"==typeof define&&define.amd?define([],e):t.Grapho=e()}(this,function(){"use strict";function t(e){return this instanceof t?(this.defs=o.object.merge({},i),"undefined"!=typeof e.theme?o.object.is(e.theme)?this.defs=o.object.merge(this.defs,o.object.merge(n.dark,e.theme)):"undefined"!=typeof n[e.theme]?this.defs=o.object.merge(this.defs,n[e.theme]):console.error("Grapho: Theme not found ("+e.theme+")"):this.defs=o.object.merge(this.defs,n.dark),this.yAxises=[],this.xAxises=[],this.datasets=[],this.container=this.defs.container,this.settings=o.object.merge(this.defs.settings,e),this.id=s.push(this)-1,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.w=0,this.h=0,this.wsw=0,this.wsh=0,this.wox=0,this.woy=0,this.nwox=0,this.nwoy=0,e.place&&this.place(e.place),void(this.done=!0)):new t(e)}var e,s=[],a={"default":function(t){return o.math.isNumber(t)?Math.round(1e4*t)/1e4:t},datetime:function(t){return o.math.isNumber(t)?new Date(1e3*t).toLocaleString():t},date:function(t){return o.math.isNumber(t)?new Date(1e3*t).toLocaleDateString():t},time:function(t){return o.math.isNumber(t)?new Date(1e3*t).toLocaleTimeString():t}},i={container:{width:"auto",height:"auto"},settings:{margin:5,showLegend:!1,legend:{position:"bottom",inside:!1},startAngle:90,sizePercent:1,relative:!0,innerMargin:3},dataset:{type:"line",x:{axis:1},y:{axis:1},lineWidth:2,lineSmooth:!0,dotWidth:4,widthPrc:90,_labels:[],_usedPos:[],_usedNeg:[],_data:[]},axis:{min:"auto",max:"auto",showscale:!1,gridLines:!1,name:void 0,labels:!1,labelFormat:a["default"],labelRotation:0,showCenter:!1,majorTickHeight:4,center:0,padded:!1,stacked:!1,numeric:!0,extra:0,_nameTextSize:0,_labelTextSize:0,_h:void 0,_step:1/0,_steps:0,_minStepPrc:1,_range:0,_startMinVal:0,_minVal:1/0,_maxVal:-(1/0),_padded:!1,_values:[],_labels:[],_usedPos:[],_usedNeg:[]}},n={dark:{settings:{fillStyle:"rgb(0,0,0,0)",legend:{fillStyle:"none",strokeStyle:"none",font:"11px Droid Sans"}},dataset:{strokeStyle:"#454545",fillStyle:"#343536"},axis:{scaleStyle:"#FFFFFF",gridStyle:"#353637",nameFont:"auto",nameStyle:"auto",labelFont:"11px Droid Sans",labelStyle:"auto"}},light:{settings:{fillStyle:"rgb(0,0,0,0)",legend:{fillStyle:"none",strokeStyle:"none",font:"11px Droid Sans"}},dataset:{strokeStyle:"#AAAAAA",fillStyle:"#F0F099"},axis:{scaleStyle:"#AAAAAA",gridStyle:"#BBBBBB",nameFont:"auto",nameStyle:"auto",labelFont:"11px Droid Sans",labelStyle:"auto"}}},o={array:{is:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},unique:function(t){for(var e={},s=[],a=0,i=t.length;i>a;++a)e.hasOwnProperty(t[a])||(s.push(t[a]),e[t[a]]=1);return s}},object:{is:function(t){return"[object Object]"===Object.prototype.toString.call(t)},merge:function(t,e,s){var a;"undefined"==typeof s&&(t=o.object.merge({},t,!0));for(a in e)"undefined"!=typeof e[a]&&(t[a]&&"[object Object]"===Object.prototype.toString.call(t[a])?t[a]=o.object.merge(o.object.merge({},t[a]),e[a],!0):"[object Array]"===o.array.is(e[a])?t[a]=e[a].slice():t[a]=e[a]);return t}},renderers:{area:function(t,e,s,a,i){o.renderers.line(t,e,s,a,i)},box:function(t,e,s,a,i){o.renderers.error(t,e,s,a,i)},ohlc:function(t,e,s,a,i){o.renderers.error(t,e,s,a,i)},candle:function(t,e,s,a,i){o.renderers.error(t,e,s,a,i)},line:function(t,e,s,a,i){var n,o,h,r,l,d,x,m,c,u,_,y;for(e.beginPath(),l=a._minStepPrc,l*=t.wsw-l*t.wsw*(a._padded?1:0),d=a._padded?l/2:0,x=t.wsw-2*d,o=0;o<s.data.length;o++)(n=s.data[o])&&(y=(n[0]-a._minVal)/a._range,m=Math.round(t.wox+d+x*y),c=Math.round(t.woy+(n[1]+n[3]-i._minVal)/i._range*t.wsh),o?s.lineSmooth&&o<s.data.length-1?(h=s.data[o+1],r=(h[0]-a._minVal)/a._range,e.quadraticCurveTo(m,c,(m+(h?Math.round(t.wox+d+x*r):0))/2,(c+(h?Math.round(t.woy+(h[1]-i._minVal)/i._range*t.wsh):0))/2)):e.lineTo(m-1,c):e.moveTo(_=m+1,c));e.lineWidth=s.lineWidth,e.strokeStyle=s.strokeStyle,e.stroke(),"area"===s.type&&(u=Math.round(t.woy+((i.center<i._minVal?i._minVal:i.center>i._maxVal?i._maxVal:i.center)-i._minVal)/i._range*t.wsh)+.5,e.lineTo(m-1,u),e.lineTo(_,u),e.strokeStyle="rgba(0,0,0,0)",e.stroke(),e.fillStyle=s.fillStyle,e.fill())},band:function(t,e,s,a,i){var n,o,h,r,l,d,x,m,c,u,_,y,f,g;for(e.beginPath(),x=a._minStepPrc,x*=t.wsw-x*t.wsw*(a._padded?1:0),m=a._padded?x/2:0,c=t.wsw-2*m,h=0;2>h;h++)for(o=0;o<s.data.length;o++)r=0===h?o:s.data.length-o-1,(n=s.data[r])&&(g=(n[0]-a._minVal)/a._range,u=Math.round(t.wox+m+c*g),_=Math.round(t.woy+(n[1][h]-i._minVal)/i._range*t.wsh),r||0!==h?s.lineSmooth&&r<s.data.length-1&&r>0?(l=s.data[r+(h?-1:1)],d=(l[0]-a._minVal)/a._range,e.quadraticCurveTo(u,_,(u+(l?Math.round(t.wox+m+c*d):0))/2,(_+(l?Math.round(t.woy+(l[1][h]-i._minVal)/i._range*t.wsh):0))/2)):e.lineTo(u-1,_):e.moveTo(y=u+1,f=_));e.fillStyle=s.fillStyle,e.fill()},error:function(t,e,s,a,i){var n,o,h,r,l,d,x,m,c,u,_,y,f;for(h=a._minStepPrc,h*=t.wsw-h*t.wsw*(a._padded?1:0),r=a._padded?h/2:0,l=t.wsw-2*r,x=h*(100-s.widthPrc)/100,d=h-x,e.lineWidth=s.lineWidth,e.strokeStyle=s.strokeStyle,e.fillStyle=s.fillStyle,o=0;o<s.data.length;o++)(n=s.data[o])&&(m=Math.round(t.wox-h/2+r+x/2+(n[0]-a._minVal)/a._range*l),c=Math.round(t.woy+(n[1][0]-i._minVal)/i._range*t.wsh),u=Math.round(t.woy+(n[1][1]-i._minVal)/i._range*t.wsh),_=Math.round(t.woy+(n[1][2]-i._minVal)/i._range*t.wsh),y=Math.round(t.woy+(n[1][3]-i._minVal)/i._range*t.wsh),f=Math.round(t.woy+(n[1][4]-i._minVal)/i._range*t.wsh),e.beginPath(),("error"===s.type||"box"===s.type)&&(e.moveTo(m,c),e.lineTo(m+d,c)),e.moveTo(Math.round(m+d/2),c),e.lineTo(Math.round(m+d/2),u),"ohlc"===s.type&&(e.moveTo(m,_),e.lineTo(m+d/2,_),e.moveTo(m+d/2,y),e.lineTo(m+d,y)),e.stroke(),e.beginPath(),("candle"===s.type||"box"===s.type)&&(e.fillRect(m,_,d,y-_),e.strokeRect(m,_,d,y-_)),"box"===s.type&&(e.moveTo(m,f),e.lineTo(m+d,f)),("error"===s.type||"box"===s.type)&&(e.moveTo(m,u),e.lineTo(m+d,u)),e.stroke())},bar:function(t,e,s,a,i){var n,o,h,r,l,d,x,m,c,u,_,y;for(r=a._minStepPrc,r*=t.wsw-r*t.wsw*(a._padded?1:0),h=a._padded?r/2:0,y=t.wsw-2*h,d=r*(100-s.widthPrc)/100,x=r-d,l=0;l<s.data.length;l++)(n=s.data[l])&&(o=(n[0]-a._minVal)/a._range,m=Math.round(t.wox-r/2+h+d/2+o*y),c=Math.round(t.woy+(n[1]+n[3]-i._minVal)/i._range*t.wsh),u=Math.round(t.woy+(n[3]-i._minVal)/i._range*t.wsh)-c,(_=Math.abs(u)>2*s.lineWidth)?e.fillStyle=s.fillStyle:e.fillStyle=s.strokeStyle,e.fillRect(m,c,x,u),s.lineWidth>0&&_&&(e.strokeStyle=s.strokeStyle,e.lineWidth=s.lineWidth,e.strokeRect(Math.round(m+e.lineWidth/2),Math.round(c-e.lineWidth/2),x-e.lineWidth-.5,u+e.lineWidth-1)))},scatter:function(t,e,s,a,i){var n,o,h,r,l,d;for(h=a._minStepPrc,h*=t.wsw-h*t.wsw*(a._padded?1:0),r=a._padded?h/2:0,d=t.wsw-2*r,l=0;l<s.data.length;l++)(n=s.data[l])&&(o=(n[0]-a._minVal)/a._range,e.beginPath(),e.arc(Math.round(t.wox+r+d*o),Math.round(t.woy+(n[1]+n[3]-i._minVal)/i._range*t.wsh),s.dotWidth,0,2*Math.PI),e.fillStyle=s.fillStyle,e.fill())},pie:function(t,e,s,a,i){function n(t,e,s,a,i,n,h){var r=t.wsw/2+t.wox,l=t.wsh/2+t.woy,d=(t.wsw>t.wsh?t.wsh:t.wsw)/2,x=d*i,m=d*n+t.settings.innerMargin,c=(s+t.settings.startAngle)*o.math.degToRad,u=(a+.5)*o.math.degToRad,_=c+u;h="undefined"==typeof h?!0:h,e.beginPath(),e.arc(r,l,x,c,_,!1),e.arc(r,l,m,_,c,!0),e.closePath(),e.fill()}var h,r,l=1,d=1-t.settings.sizePercent;for(h=0;h<s.data.length;h++)r=l-h/s.data.length*(l-d),e.fillStyle=s.fillStyle,n(t,e,s.data[h][3]/i._usedPos[h]*360,s.data[h][1]/i._usedPos[h]*360,r+.01,r-1/s.data.length*(l-d))}},math:{degToRad:.0174532925,log10:function(t){return Math.log(t)/Math.LN10},isNumber:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},isInt:function(t){return t%1===0},bboxrot:function(t,e,s){return s=o.math.degToRad*s,{width:Math.max(Math.abs(t*Math.cos(s)+e*Math.sin(s)),Math.abs(t*Math.cos(s)-e*Math.sin(s))),height:Math.max(Math.abs(-t*Math.sin(s)+e*Math.cos(s)),Math.abs(-t*Math.sin(s)-e*Math.cos(s)))}}}};return e=t.prototype,t.formats=e.formats=a,t.helpers=e.helpers=o,e.place=function(t){var e;return"string"==typeof t&&(t=document.getElementById(t)),(e=t&&(t.appendChild?"appendChild":"append"))&&(this.dest=t,this.dest[e](this.canvas),this.resize(this)),this},e.removeDataset=function(t){var e;e=this.datasets.indexOf(t),-1!==e&&this.datasets.splice(e,1)},e.addDataSet=function(t){var e=o.array.is(t);if("object"!=typeof t)return this;if(!e&&!t.data)return this;var s=this.defs.dataset;return e?s.data=t:s=o.object.merge(s,t),"bar"===t.type&&"undefined"==typeof t.lineWidth&&(s.lineWidth=0),this.yAxises[s.y.axis]=o.object.merge(this.defs.axis,o.object.merge(this.yAxises[s.y.axis],s.y)),this.xAxises[s.x.axis]=o.object.merge(this.defs.axis,o.object.merge(this.xAxises[s.x.axis],s.x)),this.pushDataset(s),this.done&&this.redraw(),s},e.updateAxises=function(t){var e,s,a,i=this.yAxises[t.y.axis],n=this.xAxises[t.x.axis],h=t.data.length,r=[],l=[];if(!o.array.is(t.data[0]))for(e=0;h>e;e++)r[e]=t.data[e],l[e]=e,t.data[e]=[e,t.data[e]];for(e=0;h>e;e++){if("undefined"!=typeof t.data[e][2]&&(t.data[e][0]=t.data[e][2]),o.math.isNumber(t.data[e][0]))a=e,l[e]=t.data[e][2]=n._labels[e]=t.data[e][0];else{for(a=-1,s=0;s<n._labels.length;s++)n._labels[s]===t.data[e][0]&&(a=s);t.data[e][2]=t.data[e][0],a>-1?t.data[e][0]=l[e]=a:(a=n._labels.push(t.data[e][0])-1,t.data[e][0]=l[e]=a)}o.array.is(t.data[e][1])?r=r.concat(t.data[e][1]):r[e]=t.data[e][1],t.data[e][3]=0,o.array.is(t.data[e][1])||("undefined"==typeof i._usedPos[a]&&(i._usedPos[a]=0),"undefined"==typeof i._usedNeg[a]&&(i._usedNeg[a]=0),(i.stacked||"pie"===t.type||"progress"===t.type)&&(t.data[e][1]>=i.center?(t._usedPos[a]=t.data[e][3]="undefined"==typeof i._usedPos[a]?0:i._usedPos[a],i._usedPos[a]+=t.data[e][1]):(t._usedNeg[a]=t.data[e][3]="undefined"==typeof i._usedNeg[a]?0:i._usedNeg[a],i._usedNeg[a]+=t.data[e][1])))}return"string"==typeof t.data[0][0]&&(n.numeric=!0),i.stacked?(i._maxVal="auto"!==i.max?i.max:Math.max(Math.max.apply(null,i._usedPos)+i.extra,i._maxVal),i._minVal="auto"!==i.min?i.min:Math.min(Math.min.apply(null,i._usedNeg)-i.extra,i._minVal)):(i._maxVal="auto"!==i.max?i.max:Math.max(Math.max.apply(null,r)+i.extra,i._maxVal),i._minVal="auto"!==i.min?i.min:Math.min(Math.min.apply(null,r)-i.extra,i._minVal)),n._maxVal="auto"!==n.max?n.max:Math.max(Math.max.apply(null,l)+n.extra,n._maxVal),n._minVal="auto"!==n.min?n.min:Math.min(Math.min.apply(null,l)-n.extra,n._minVal),n._values=o.array.unique(n._values.concat(l)),i._values=o.array.unique(i._values.concat(r)),n._range=n._maxVal-n._minVal,i._range=i._maxVal-i._minVal,t.data.sort(function(t,e){return t[0]-e[0]}),n=this.calcMinStep(n,t.data,0),i=this.calcMinStep(i,t.data,1),n.numeric!==!0?(n._step=1,n._steps=n._labels.length-1):n=this.calcAxisSteps(n),i=this.calcAxisSteps(i),("bar"===t.type||"error"===t.type||"ohlc"===t.type||"candle"===t.type||"box"===t.type)&&(n._padded=!0),this},e.pushDataset=function(t){var e;for(this.xAxises[t.x.axis]._values=[],this.yAxises[t.y.axis]._values=[],this.xAxises[t.x.axis]._labels=[],this.xAxises[t.x.axis]._minVal=1/0,this.xAxises[t.x.axis]._maxVal=-(1/0),this.xAxises[t.x.axis]._minVal=1/0,this.xAxises[t.x.axis]._maxVal=-(1/0),this.yAxises[t.y.axis]._labels=[],this.yAxises[t.y.axis]._usedPos=[],this.yAxises[t.y.axis]._usedNeg=[],this.yAxises[t.y.axis]._minVal=1/0,this.yAxises[t.y.axis]._maxVal=-(1/0),e=0;e<this.datasets.length;e++)(this.datasets[e].x.axis===t.x.axis||this.datasets[e].y.axis===t.y.axis)&&this.updateAxises(this.datasets[e]);return this.updateAxises(t),this.datasets.push(t),this},e.calcAxisSteps=function(t,e){e="undefined"==typeof e?15:e;var s,a,i,n,h,r,l,d;return s=t._range/e,d=t._range*t._minStepPrc,i=Math.floor(o.math.log10(s)),n=Math.pow(10,i),a=Math.round(s/n+.5),a>5?a=10:a>2?a=5:a>1&&(a=2),l=a*n,d>l&&(l=d),t._startMinVal=t._minVal-t._minVal%l,t._startMinVal<t._minVal&&(t._startMinVal=t._minVal),h=Math.round(Math.ceil(t._range/l)),r=l*h,t._step=l,t._steps=h,t},e.calcMinStep=function(t,e,s){var a,i,n,o,h=t._minStepPrc;for(a=0;a<e.length;a++)(o=e[a])&&(n=(o[s]-t._minVal)/t._range,"undefined"!=typeof i&&h>n-i&&(h=n-i),i=n);return t._minStepPrc=h,t},e.drawAxis=function(t,e,s,a){var i,n,h,r,l,d,x,m,c,u,_,y,f,g,w,p,b,S;for(t.lineWidth=1,t.strokeStyle=e.gridStyle,r="x"===s?this.w:this.h,l="x"===s?this.h:this.w,"x"===s?(t.save(),t.scale(1,-1),t.translate(0,-this.h),t.translate(0,l),t.rotate(-.5*Math.PI),u=this.wsh,_=this.wsw,y=this.woy,f=this.wox):(u=this.wsw,_=this.wsh,f=this.woy,y=this.wox),w=e._minStepPrc,w*=u-w*u*(e._padded?1:0),b=e._padded?w/2:0,p=u-2*b,t.font=e.labelFont,d=[+Math.abs(e._step),-Math.abs(e._step)],x=0;x<d.length;x++)for(m=e._startMinVal;m<=e._maxVal&&m>=e._minVal;)i=Math.round(y+b+(m-e._minVal)/e._range*p),e.showGridLines&&(t.beginPath(),t.moveTo(i,f),t.lineTo(i,f+_),t.strokeStyle=e.gridStyle,t.stroke()),e.labels&&(t.font=e.labelFont,t.save(),t.beginPath(),S=e.labelRotation+90+("y"===s?90:0),g=e._labels&&"undefined"!=typeof e._labels[m]?e.labelFormat(e._labels[m]):e.labelFormat(m),c=o.math.bboxrot(t.measureText(g).width,e._labelTextSize,S),"y"===s?(t.scale(-1,1),t.translate(-this.w,0),n=l-i):n=i,h=e._offset+e._h-1.2*c.height/2-(e.showScale?e.majorTickHeight+1:0)-2,a||(h=r-h),t.translate(n,h),t.rotate(S*o.math.degToRad),t.translate(-t.measureText(g).width/2,e._labelTextSize/3),t.fillStyle="auto"===e.labelStyle?e.scaleStyle:e.labelStyle,t.fillText(g,0,0),t.restore()),e.showScale&&(t.beginPath(),n=e._offset+e._h-1,a?(t.moveTo(i,n),t.lineTo(i,n-e.majorTickHeight)):(t.moveTo(i,r-n),t.lineTo(i,r-n+e.majorTickHeight)),t.strokeStyle=e.scaleStyle,t.stroke()),m+=d[x];e.showCenter&&e.center>e._minVal&&e.center<e._maxVal&&(i=Math.round(y+b+(e.center-e._minVal)/e._range*p),t.beginPath(),t.moveTo(i,f),t.lineTo(i,f+_),t.strokeStyle=e.scaleStyle,t.stroke()),e.showScale&&(t.beginPath(),a?(t.moveTo(y,e._offset+e._h-1),t.lineTo(y+u,e._offset+e._h-1)):(t.moveTo(y,r-e._offset-e._h+1),t.lineTo(y+u,r-e._offset-e._h+1)),t.strokeStyle=e.scaleStyle,t.stroke()),t.font=e.nameFont,e.name&&(t.font="auto"===e.nameFont?e.labelFont:e.nameFont,t.fillStyle="auto"===e.nameStyle?e.scaleStyle:e.nameStyle,i=a?e._offset+e._nameTextSize/1.2:r-e._offset-e._nameTextSize/2.2,t.save(),"y"===s?(t.scale(1,-1),t.translate(0,-this.h),n=r-i+e._nameTextSize/1.9):n=i,t.fillText(e.name,y+u/2-t.measureText(e.name).width/2,n),t.restore()),"x"===s&&t.restore()},e.drawLegend=function(t,e){var s,a,i,n=0,o=0,h=1,r=3,l=1.2*parseInt(t.font.split(" ")[0]),d=l,x=t.inside?this.nwoy:this.settings.margin,m=t.inside?this.wox+5:this.settings.margin,c=t.inside?this.wsw:this.w,u=t.inside?this.wsh:this.h;for(this.ctx.font=t.font,s=0;s<this.datasets.length;s++)"undefined"==typeof this.datasets[s].name&&(this.datasets[s].name="Series "+(s+1)),"bottom"===t.position||"top"===t.position?(o+this.ctx.measureText(this.datasets[s].name).width+d+l>c&&(h+=1,o=0),o+=this.ctx.measureText(this.datasets[s].name).width+d+l,n=l*h):((i=this.ctx.measureText(this.datasets[s].name).width)>o&&(o=i),n=o+d);if(!e)for(o=0,h=1,s=0;s<this.datasets.length;s++)this.ctx.fillStyle=this.datasets[s].fillStyle,this.ctx.strokeStyle=this.datasets[s].strokeStyle,"bottom"===t.position||"top"===t.position?(o+this.ctx.measureText(this.datasets[s].name).width+d+l>c&&(h+=1,o=0),a=("bottom"===t.position?u+x-n:x)+(h-1)*l+r,this.ctx.fillRect(o+m,a,l-2*r,l-2*r),this.ctx.strokeRect(o+m,a,l-2*r,l-2*r),this.ctx.fillText(this.datasets[s].name,o+l+m,a+l/1.35),o+=this.ctx.measureText(this.datasets[s].name).width+d+l):(a="right"===t.position?c+m-n:m,this.ctx.fillRect(a,x+(h-1)*l+r,l-2*r,l-2*r),this.ctx.strokeRect(a,x+(h-1)*l+r,l-2*r,l-2*r),this.ctx.fillText(this.datasets[s].name,a+l,x+(h-1)*l+l/1.35),h+=1);return n},e.calcAxisSpace=function(t,e,s){var a,i,n,h;if(t._labelTextSize=t.labels?parseInt(t.labelFont.split(" ")[0]):0,t._nameTextSize="undefined"!=typeof t.name?"auto"!==t.nameFont?parseInt(t.nameFont.split(" ")[0]):parseInt(t.labelFont.split(" ")[0]):0,t._h=0,t._h+=t.showScale?1:0,t._h+=t.showScale?t.majorTickHeight:0,t._h+=t.name?1.7*t._nameTextSize:0,t.labels){for(e.font=t.labelFont,a=0,i=t._minVal;i<=t._maxVal;i+=t._step)n=t._labels&&"undefined"!=typeof t._labels[i]?e.measureText(t.labelFormat(t._labels[i])).width:e.measureText(t.labelFormat(i)).width,h=t._labelTextSize,n=1.2*o.math.bboxrot(n,h,t.labelRotation+("x"===s?90:0)).width,1,n>a&&(a=n);t._h+=a}return t},e.redraw=function(){var t,e,s,a,i;this.wsw=this.w-2*this.settings.margin,this.wsh=this.h-2*this.settings.margin,this.wox=this.settings.margin,this.woy=this.settings.margin,this.nwox=this.settings.margin,this.nwoy=this.settings.margin,this.settings.showLegend&&!this.settings.legend.inside&&(a=this.drawLegend(this.settings.legend,!0)+this.settings.margin,"bottom"===this.settings.legend.position?(this.woy+=a,this.wsh-=a):"top"===this.settings.legend.position?(this.nwoy+=a,this.wsh-=a):"left"===this.settings.legend.position?(this.wox+=a,this.wsw-=a):"right"===this.settings.legend.position&&(this.nwox+=a,this.wsw-=a));for(t in this.yAxises)this.yAxises.hasOwnProperty(t)&&(this.yAxises[t]=this.calcAxisSpace(this.yAxises[t],this.ctx,"y"),this.wsw-=this.yAxises[t]._h,this.yAxises[t]._offset=t%2?this.wox:this.nwox,t%2?this.wox+=this.yAxises[t]._h:this.nwox+=this.yAxises[t]._h);for(t in this.xAxises)this.xAxises.hasOwnProperty(t)&&(this.xAxises[t]=this.calcAxisSpace(this.xAxises[t],this.ctx,"x"),this.wsh-=this.xAxises[t]._h,this.xAxises[t]._offset=t%2?this.woy:this.nwoy,t%2?this.woy+=this.xAxises[t]._h:this.nwoy+=this.xAxises[t]._h);i=this.ctx,i.clearRect(0,0,this.w,this.h),i.save(),i.translate(.5,.5),i.scale(1,-1),i.translate(0,-this.h);for(t in this.yAxises)this.yAxises.hasOwnProperty(t)&&this.drawAxis(i,this.yAxises[t],"x",t%2);for(t in this.xAxises)this.xAxises.hasOwnProperty(t)&&this.drawAxis(i,this.xAxises[t],"y",t%2);for(e=this.datasets.length-1;e>=0;e--)s=this.datasets[e],void 0!==o.renderers[s.type]||"area"===s.type?o.renderers[s.type](this,i,s,this.xAxises[s.x.axis],this.yAxises[s.y.axis]):console.error("Grapho: Missing renderer '"+s.type+"', cannot render dataset.");i.restore(),this.settings.showLegend&&this.drawLegend(this.settings.legend,!1)},e.resize=function(){return"auto"===(this.w=this.container.width)&&(this.w=getComputedStyle(this.dest,null).getPropertyValue("width")),"auto"===(this.h=this.container.height)&&(this.h=getComputedStyle(this.dest,null).getPropertyValue("height")),this.canvas.height=this.h=parseInt(this.h),this.canvas.width=this.w=parseInt(this.w),this.redraw(),this},window.addEventListener("resize",function(){for(var t,e=0;t=s[e++];)t.resize()}),t});